<custom-nav />

<view class="container">

  <view class="repo-list">
    <!-- Skeleton Loading -->
    <block wx:if="{{loading}}">
      <skeleton-loader type="card" count="3" />
    </block>

    <!-- Empty State -->
    <block wx:elif="{{repos.length === 0}}">
      <empty-state 
        icon="ðŸš—"
        title="è¿˜æ²¡æœ‰æ·»åŠ è½¦è¾†"
        description="ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ï¼Œæ·»åŠ ä½ çš„ç¬¬ä¸€è¾†çˆ±è½¦"
        actionText="æ·»åŠ è½¦è¾†"
        bind:action="goToCreate"
      />
    </block>

    <!-- Repo List -->
    <block wx:else>
      <view class="card-wrapper" wx:for="{{repos}}" wx:key="_id">
        <!-- Swipe Actions (Right side, revealed by swiping left) -->
        <view class="swipe-actions">
           <view class="action-btn edit" catchtap="editRepo" data-id="{{item._id}}">ç¼–è¾‘</view>
           <view class="action-btn delete" catchtap="deleteRepo" data-id="{{item._id}}" data-index="{{index}}">åˆ é™¤</view>
        </view>

        <view class="repo-card" style="background: {{item.color || '#2c3e50'}}; transform: translateX({{item.offsetX || 0}}px)" bindtap="goToDetail" data-id="{{item._id}}" data-index="{{index}}" bindtouchstart="touchStart" bindtouchmove="touchMove" bindtouchend="touchEnd">
          <view class="card-content">
            <view class="repo-name">{{item.name}}</view>
            <view class="repo-info">
              <text class="mileage">{{item.current_mileage}} km</text>
              <text class="vehicle-age" wx:if="{{item.vehicle_age}}">{{item.vehicle_age}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- Add Button Below Cards -->
      <view class="add-card ripple" bindtap="goToCreate">
        <text class="add-icon">+</text>
        <text class="add-text">æ·»åŠ è½¦è¾†</text>
      </view>

    </block>
  </view>
</view>
